<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Security Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f0f0f0;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
        }
        .pass { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .fail { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .test-password {
            font-family: monospace;
            background-color: #f8f9fa;
            padding: 4px 8px;
            border-radius: 4px;
            margin: 0 4px;
        }
    </style>
</head>
<body>
    <h1>Password Security Implementation Test</h1>
    
    <div class="test-section">
        <h2>Test Results</h2>
        <div id="testResults"></div>
    </div>

    <script type="module">
        // Import the auth service to test password validation
        import auth from './static/js/auth.js';

        // Test passwords - weak to strong
        const testPasswords = [
            { password: "123456", expected: false, description: "Very weak - common pattern" },
            { password: "password", expected: false, description: "Very weak - common word" },
            { password: "Password1", expected: false, description: "Weak - too short" },
            { password: "abc123ABC!", expected: false, description: "Weak - too short and sequential" },
            { password: "MySecur3P@ss", expected: true, description: "Good - meets all requirements" },
            { password: "Str0ng!P@ssw0rd123", expected: true, description: "Strong - long and complex" },
            { password: "Complex!P@ssw0rd2024#", expected: true, description: "Very strong - very long and complex" },
            { password: "abcdefghijklmnop", expected: false, description: "Weak - no uppercase, numbers, specials" },
            { password: "ABCDEFGHIJKLMNOP", expected: false, description: "Weak - no lowercase, numbers, specials" },
            { password: "12345678901234567890", expected: false, description: "Weak - only numbers" },
            { password: "!@#$%^&*()_+{}|:<>?", expected: false, description: "Weak - only special characters" },
            { password: "MyVerySecure!Password123", expected: true, description: "Excellent - all requirements met" }
        ];

        function runPasswordTests() {
            const resultsDiv = document.getElementById('testResults');
            let passCount = 0;
            let totalTests = testPasswords.length;

            testPasswords.forEach((test, index) => {
                const validation = auth.validatePasswordSecurity(test.password);
                const passed = validation.isValid === test.expected;
                
                if (passed) passCount++;

                const resultDiv = document.createElement('div');
                resultDiv.className = `test-result ${passed ? 'pass' : 'fail'}`;
                
                resultDiv.innerHTML = `
                    <strong>Test ${index + 1}:</strong> ${test.description}<br>
                    <strong>Password:</strong> <span class="test-password">${test.password}</span><br>
                    <strong>Expected:</strong> ${test.expected ? 'Valid' : 'Invalid'}<br>
                    <strong>Actual:</strong> ${validation.isValid ? 'Valid' : 'Invalid'}<br>
                    <strong>Strength Score:</strong> ${validation.strength}%<br>
                    <strong>Status:</strong> ${passed ? '✅ PASS' : '❌ FAIL'}<br>
                    ${validation.errors.length > 0 ? `<strong>Errors:</strong> ${validation.errors.join(', ')}` : ''}
                `;
                
                resultsDiv.appendChild(resultDiv);
            });

            // Add summary
            const summaryDiv = document.createElement('div');
            summaryDiv.className = `test-result ${passCount === totalTests ? 'pass' : 'fail'}`;
            summaryDiv.innerHTML = `
                <h3>Test Summary</h3>
                <strong>Passed:</strong> ${passCount}/${totalTests} tests<br>
                <strong>Success Rate:</strong> ${Math.round((passCount/totalTests) * 100)}%<br>
                <strong>Overall Result:</strong> ${passCount === totalTests ? '✅ ALL TESTS PASSED' : '❌ SOME TESTS FAILED'}
            `;
            resultsDiv.appendChild(summaryDiv);
        }

        // Run tests when the page loads
        document.addEventListener('DOMContentLoaded', runPasswordTests);
    </script>
</body>
</html>